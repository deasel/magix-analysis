!function(){var o=Date.now||function(){return(new Date).getTime()},t=window.KISSY,n={isReady:function(){var o=t.Env.mods,n=t.Loader.Status,a=o["magix/magix"];if(a){var e=o["magix/vom"];return a.status===n.ATTACHED&&e&&e.status===n.ATTACHED}return a=o.magix,a&&a.status===n.ATTACHED},getRootVId:function(){var o,n=t.Env.mods["magix/magix"];return o=n?t.require("magix/magix"):t.require("magix"),o.config("rootId")},getVOM:function(){var o=t.Env.mods["magix/magix"];if(o)return t.require("magix/vom");var n=t.require("magix");return n.VOM||n.Vframe},getRouter:function(){var o=t.Env.mods["magix/magix"];if(o)return t.require("magix/router");var n=t.require("magix");return n.Router},hookAjax:function(n){var a=t.IO||t.Ajax;a.on("send",function(t){t.ajaxConfig.__begin=o()}),a.on("success",function(t){var a=o()-t.ajaxConfig.__begin;delete t.ajaxConfig.__begin,n({url:t.ajaxConfig.url,duration:a,isJSONP:!!t.ajaxConfig.jsonp})})},hookAssets:function(n){var a=t.getScript;t.getScript=function(e,i,r){var u,s=i,d=o();if(t.isPlainObject(s)){var c=s.success;s.success=function(){n({url:e,duration:o()-d}),c&&c.apply(t,arguments)},u=s}else u=function(){n({url:e,duration:o()-d}),i&&i.apply(t,arguments)};return a.call(t,e,u,r)}},domReady:function(o){t.ready(o)}},a={getEnv:function(){var o=this;if(o.$env)return o.$env;if(window.KISSY)return o.$env=n;throw new Error("Analysis unsupport current enviroment")},prepare:function(o){var t=this,n=t.getEnv(),a=function(){document.body&&n.isReady()?o():setTimeout(a,500)};a()},beginHookAjax:function(t){var n=this,a=n.$hookAjaxPool;a||(a=n.$hookAjaxPool=[]),a.push(t),a["x"+t]={time:o(),count:0,duration:0}},endHookAjax:function(o){var t,n=this,a=n.$hookAjaxPool;if(a&&(t=a["x"+o])){var e=t.duration,i=t.count;delete a["x"+o];for(var r=a.length-1;r>=0;r--)a[r]==o&&a.splice(r,1);return{count:i,duration:e}}return{count:-1,duration:-1}},hookAjax:function(){var t=this,n=t.getEnv();n.hookAjax(function(n){n.type="request",t.log(n);var a=t.$hookAjaxPool;if(a)for(var e,i=a.length-1;i>=0;i--)e=a["x"+a[i]],e.duration+=o()-e.time,e.time=o(),e.count++})},beginHookAssets:function(t){var n=this,a=n.$hookAssetsPool;a||(a=n.$hookAssetsPool=[]),a.push(t),a["a"+t]={time:o(),count:0,duration:0}},endHookAssets:function(o){var t,n=this,a=n.$hookAssetsPool;if(a&&(t=a["a"+o])){var e=t.duration,i=t.count;delete a["a"+o];for(var r=a.length-1;r>=0;r--)a[r]==o&&a.splice(r,1);return{count:i,duration:e}}return{count:-1,duration:-1}},hookAssets:function(){var t=this,n=t.getEnv();n.hookAssets(function(n){n.type="assets",t.log(n);var a=t.$hookAssetsPool;if(a)for(var e,i=a.length-1;i>=0;i--)e=a["a"+a[i]],e.duration+=o()-e.time,e.time=o(),e.count++})},monitor:function(t){var n,a=this,e=a.getEnv(),i=e.getRouter(),r=o();a.beginHookAjax("first"),a.beginHookAssets("first"),t.on("created",function(){var t=n;n=null;var e,u;setTimeout(function(){if(t)e=a.endHookAssets(t.url),u=a.endHookAjax(t.url),t.end=o(),t.duration=t.end-t.begin,t.apiDuration=u.duration,t.apiCount=u.count,t.assetsDuration=e.duration,t.assetsCount=e.count,a.log(t);else if(e=a.endHookAssets("first"),u=a.endHookAjax("first"),e.count>-1){var n=i.parseQH?i.parseQH():i.parse();a.log({type:"pageloaded",duration:o()-r,url:n.path||n.pathname,apiDuration:u.duration,apiCount:u.count,assetsDuration:e.duration,assetsCount:e.count})}},0)}),i.on("changed",function(t){var e=t.changed||t;n&&(n.action="discard",n.end=o(),n.duration=n.end-n.begin,a.log(n));var i="isPath",r="path";if(e.isPathname&&(i="isPathname",r="pathname"),e[i]()){var u=e[r];n={begin:o(),type:"pathchanged",from:u.from,to:u.to,url:u.to},a.beginHookAjax(n.url),a.beginHookAssets(n.url)}})},start:function(){var t=o(),n=this,a=n.getEnv();a.domReady(function(){n.log({type:"domready",duration:o()-t})}),n.prepare(function(){n.log({type:"prepareReady",duration:o()-t});var e=a.getVOM(),i=a.getRootVId(),r=e.get(i);if(n.hookAjax(),n.hookAssets(),r)n.log({type:"rootVfReady",duration:0}),n.monitor(r);else{t=o();var u=function(a){a.vframe.id==i&&(n.log({type:"rootVfReady",duration:o()-t}),e.off("add",u),n.monitor(a.vframe))};e.on("add",u)}})},log:function(o){var t=e[o.type];t&&t(o)}},e={send:function(o){var t=["gmkey=zuanshi"];for(var n in o)t.push(n+"="+encodeURIComponent(o[n]));(new Image).src="https://gm.mmstat.com/alimama.12?"+t.join("&")},domReady:function(o){e.$ready=o.duration},pageloaded:function(o){var t={is_whole_load:1,logtype:"page",url:o.url,timeconsuming:o.duration,apiCount:o.apiCount,assetsCount:o.assetsCount,apiDuration:o.apiDuration,assetsDuration:o.assetsDuration};e.$ready&&(t.domready_time=e.$ready),e.send(t)},pathchanged:function(o){var t={is_whole_load:0,logtype:"page",url:o.url,from:o.from,timeconsuming:o.duration,apiCount:o.apiCount,assetsCount:o.assetsCount,apiDuration:o.apiDuration,assetsDuration:o.assetsDuration};o.action&&(t.action=o.action),e.send(t)},request:function(o){var t={speed:o.duration,url:o.url,logtype:"api"};e.send(t)},assets:function(o){var t={speed:o.duration,url:o.url,logtype:"assets"};e.send(t)}};a.start()}();